<!DOCTYPE html>
<html>

<head>
  <title>Boys and Girls</title>
  <script src="https://unpkg.com/jspsych@8.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.3"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-video-keyboard-response@1.1.3"></script>

  <!-- A custom plugin that adds a green box around the button when it's clicked -->
  <script src="script/jspsych/plugin-html-button-response-green-box.js"></script>
  <!-- A custom plugin that ends the trial when the audio is finished playing -->
  <script src="script/jspsych/plugin-html-end-trial-on-audio-finish.js"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-button-response@2.0.0"></script>

  <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
  <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
</head>

<body></body>
<!-- always init JsPsych first -->
<script src="script/init.js"></script>

<!-- load utils -->
<script src="script/utils/media.js"></script>
<script src="script/utils/stimulus.js"></script>

<!-- load trials -->
<script src="script/instruction_trial.js"></script>
<script src="script/exposure_trial.js"></script>
<script src="script/practice_trial.js"></script>
<script src="script/attention_trial.js"></script>
<script src="script/break_trial.js"></script>
<script src="script/test_trial.js"></script>
<script src="script/ending_trial.js"></script>
<script src="script/peer_preference_trial.js"></script>
<script src="script/toyClothing_preference_trial.js"></script>

<!-- load procedures -->
<script src="script/procedures/introduction.js"></script>
<script src="script/procedures/instruction_exposure_ready.js"></script>
<script src="script/procedures/break.js"></script>
<script src="script/procedures/attention.js"></script>
<script src="script/procedures/exposure.js"></script>
<script src="script/procedures/practice.js"></script>
<script src="script/procedures/exposure_practice.js"></script>
<script src="script/procedures/instruction_test.js"></script>
<script src="script/procedures/instruction_test_ready.js"></script>
<script src="script/procedures/test.js"></script>
<script src="script/procedures/peer_preference.js"></script>
<script src="script/procedures/toyClothing_preference.js"></script>
<!-- <script src="script/procedures/test_practice.js"></script> -->
<script src="script/procedures/ending.js"></script>

<!-- construct experiment -->
<script>
  var timeline = [];
  var instructions = {
    type: jsPsychHtmlButtonResponse,
    stimulus: "Welcome to the experiment!",
    choices: ["Begin"]
  };

  // preload resolves image flickering
  var preload = {
    type: jsPsychPreload,
    // Auto preload doesn't work since it only fetches plugin parameter files, not files within html and parameter functions.
    // See https://www.jspsych.org/v8/reference/jspsych-pluginAPI/#getautopreloadlist for details.  
    // auto_preload: true,
    images:
      [].concat(
        // Introduction trial 
        // introduction_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        // Exposure practice trial
        exposure_practice_trial_procedure.timeline_variables.map(item => `image/${item.image}`),
        exposure_practice_trial_procedure.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        exposure_practice_trial_procedure.timeline_variables.map(item => `image/${item.correct_button_image}`),

        // Instruction exposure ready trial
        instruction_exposure_ready_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        // Exposure trials
        exposure_procedure1_1.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure1_2.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure1_3.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure1_4.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure2_1.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure2_2.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure2_3.timeline_variables.map(item => `image/${item.image}`),
        exposure_procedure2_4.timeline_variables.map(item => `image/${item.image}`),

        practice1.timeline_variables.map(item => `image/${item.image}`),


        // Attention trials
        attention_check_procedure1_1.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure1_1.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure1_1.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure1_2.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure1_2.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure1_2.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure1_3.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure1_3.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure1_3.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure1_4.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure1_4.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure1_4.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure2_1.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure2_1.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure2_1.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure2_2.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure2_2.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure2_2.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure2_3.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure2_3.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure2_3.timeline_variables.map(item => `image/${item.correct_button_image}`),
        attention_check_procedure2_4.timeline_variables.map(item => `image/${item.image}`),
        attention_check_procedure2_4.timeline_variables.map(item => `image/${item.wrong_button_image}`),
        attention_check_procedure2_4.timeline_variables.map(item => `image/${item.correct_button_image}`),
 

        // Break trials
        break_trial_procedure.timeline_variables.map(item => `image/${item.image}`),
        // break_trial_procedure2.timeline_variables.map(item => `image/${item.image}`),
        // break_trial_procedure3.timeline_variables.map(item => `image/${item.image}`),
        // break_trial_procedure4.timeline_variables.map(item => `image/${item.image}`),

        // Instruction test trials
        instruction_test_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        // Peer preference trials
        peer_preference_task1.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task1.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task2.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task2.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task3.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task3.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task4.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task4.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task5.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task5.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task6.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task6.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task7.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task7.timeline_variables.map(item => `image/${item.right_image}`),
        peer_preference_task8.timeline_variables.map(item => `image/${item.left_image}`),
        peer_preference_task8.timeline_variables.map(item => `image/${item.right_image}`),



        // TC preference trials
        toy_preference_task1.timeline_variables.map(item => `image/${item.A_image}`),
        toy_preference_task1.timeline_variables.map(item => `image/${item.B_image}`),
        toy_preference_task1.timeline_variables.map(item => `image/${item.C_image}`),
        toy_preference_task1.timeline_variables.map(item => `image/${item.D_image}`),
        toy_preference_task1.timeline_variables.map(item => `image/${item.E_image}`),
        toy_preference_task2.timeline_variables.map(item => `image/${item.A_image}`),
        toy_preference_task2.timeline_variables.map(item => `image/${item.B_image}`),
        toy_preference_task2.timeline_variables.map(item => `image/${item.C_image}`),
        toy_preference_task2.timeline_variables.map(item => `image/${item.D_image}`),
        toy_preference_task2.timeline_variables.map(item => `image/${item.E_image}`),
        toy_preference_task3.timeline_variables.map(item => `image/${item.A_image}`),
        toy_preference_task3.timeline_variables.map(item => `image/${item.B_image}`),
        toy_preference_task3.timeline_variables.map(item => `image/${item.C_image}`),
        toy_preference_task3.timeline_variables.map(item => `image/${item.D_image}`),
        toy_preference_task3.timeline_variables.map(item => `image/${item.E_image}`),
        toy_preference_task4.timeline_variables.map(item => `image/${item.A_image}`),
        toy_preference_task4.timeline_variables.map(item => `image/${item.B_image}`),
        toy_preference_task4.timeline_variables.map(item => `image/${item.C_image}`),
        toy_preference_task4.timeline_variables.map(item => `image/${item.D_image}`),
        toy_preference_task4.timeline_variables.map(item => `image/${item.E_image}`),
        cloth_preference_task1.timeline_variables.map(item => `image/${item.A_image}`),
        cloth_preference_task1.timeline_variables.map(item => `image/${item.B_image}`),
        cloth_preference_task1.timeline_variables.map(item => `image/${item.C_image}`),
        cloth_preference_task1.timeline_variables.map(item => `image/${item.D_image}`),
        cloth_preference_task1.timeline_variables.map(item => `image/${item.E_image}`),
        cloth_preference_task2.timeline_variables.map(item => `image/${item.A_image}`),
        cloth_preference_task2.timeline_variables.map(item => `image/${item.B_image}`),
        cloth_preference_task2.timeline_variables.map(item => `image/${item.C_image}`),
        cloth_preference_task2.timeline_variables.map(item => `image/${item.D_image}`),
        cloth_preference_task2.timeline_variables.map(item => `image/${item.E_image}`),
        cloth_preference_task3.timeline_variables.map(item => `image/${item.A_image}`),
        cloth_preference_task3.timeline_variables.map(item => `image/${item.B_image}`),
        cloth_preference_task3.timeline_variables.map(item => `image/${item.C_image}`),
        cloth_preference_task3.timeline_variables.map(item => `image/${item.D_image}`),
        cloth_preference_task3.timeline_variables.map(item => `image/${item.E_image}`),
        cloth_preference_task4.timeline_variables.map(item => `image/${item.A_image}`),
        cloth_preference_task4.timeline_variables.map(item => `image/${item.B_image}`),
        cloth_preference_task4.timeline_variables.map(item => `image/${item.C_image}`),
        cloth_preference_task4.timeline_variables.map(item => `image/${item.D_image}`),
        cloth_preference_task4.timeline_variables.map(item => `image/${item.E_image}`),

        // // Test practice listen trials
        // test_practice_procedure_1_listen.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_2_listen.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_3_listen.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_4_listen.timeline_variables.map(item => `image/${item.image}`),

        // // Test practice trials
        // test_practice_procedure_1.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_1.timeline_variables.map(item => `image/${item.left}`),
        // test_practice_procedure_1.timeline_variables.map(item => `image/${item.right}`),
        // test_practice_procedure_2.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_2.timeline_variables.map(item => `image/${item.left}`),
        // test_practice_procedure_2.timeline_variables.map(item => `image/${item.right}`),
        // test_practice_procedure_3.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_3.timeline_variables.map(item => `image/${item.left}`),
        // test_practice_procedure_3.timeline_variables.map(item => `image/${item.right}`),
        // test_practice_procedure_4.timeline_variables.map(item => `image/${item.image}`),
        // test_practice_procedure_4.timeline_variables.map(item => `image/${item.left}`),
        // test_practice_procedure_4.timeline_variables.map(item => `image/${item.right}`),

        // // Instruction test ready trials
        // instruction_test_ready_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        // // Don't touch screen prompt trials
        // dont_touch_screen_prompt_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        // Test listen trials
        test_procedure_1_listen.timeline_variables.map(item => `image/${item.image}`),
        test_procedure_2_listen.timeline_variables.map(item => `image/${item.image}`),
        test_procedure_3_listen.timeline_variables.map(item => `image/${item.image}`),
        test_procedure_4_listen.timeline_variables.map(item => `image/${item.image}`),
       
        // Ending trial
        ending_trial_procedure.timeline_variables.map(item => `image/${item.image}`),

        []),

    video:
      [].concat(
        // Introduction trials
        introduction_trial_procedure1.timeline_variables.map(item => item.video[0]),
        introduction_trial_procedure2.timeline_variables.map(item => item.video[0]),
        introduction_trial_procedure3.timeline_variables.map(item => item.video[0]),

        // Exposure trials
        exposure_procedure1_1.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure1_2.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure1_3.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure1_4.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure2_1.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure2_2.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure2_3.timeline_variables.map(item => `video/${item.video}`),
        exposure_procedure2_4.timeline_variables.map(item => `video/${item.video}`),
        // Practice trials
        practice1.timeline_variables.map(item => `video/${item.video}`),

        []),

    audio:
      [].concat(
        // Introduction trial
        // introduction_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        // Exposure practice trial
        exposure_practice_trial_procedure.timeline_variables.map(item => `wav/${item.audio}`),

        // Instruction exposure ready trial
        instruction_exposure_ready_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        // Exposure trials
        // exposure_procedure1_1.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure1_2.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure1_3.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure1_4.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure2_1.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure2_2.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure2_3.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure2_4.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure3_1.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure3_2.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure3_3.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure3_4.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure4_1.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure4_2.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure4_3.timeline_variables.map(item => `wav/${item.audio}`),
        // exposure_procedure4_4.timeline_variables.map(item => `wav/${item.audio}`),

        // Attention trials
        attention_check_procedure1_1.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure1_2.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure1_3.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure1_4.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure2_1.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure2_2.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure2_3.timeline_variables.map(item => `wav/${item.audio}`),
        attention_check_procedure2_4.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure9.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure10.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure11.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure12.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure13.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure14.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure15.timeline_variables.map(item => `wav/${item.audio}`),
        // attention_check_procedure16.timeline_variables.map(item => `wav/${item.audio}`),

        // Break trials
        // break_trial_procedure1.timeline_variables.map(item => `${item.audio}`),
        // break_trial_procedure2.timeline_variables.map(item => `${item.audio}`),
        // break_trial_procedure3.timeline_variables.map(item => `${item.audio}`),
        // break_trial_procedure4.timeline_variables.map(item => `${item.audio}`),

        // Instruction test trials
        instruction_test_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        // // Test practice listen trials
        // test_practice_procedure_1_listen.timeline_variables.map(item => `${item.audio}`),
        // test_practice_procedure_2_listen.timeline_variables.map(item => `${item.audio}`),
        // test_practice_procedure_3_listen.timeline_variables.map(item => `${item.audio}`),
        // test_practice_procedure_4_listen.timeline_variables.map(item => `${item.audio}`),

        // // Test practice trials
        // test_practice_procedure_1.timeline_variables.map(item => `wav/${item.audio}`),
        // test_practice_procedure_2.timeline_variables.map(item => `wav/${item.audio}`),
        // test_practice_procedure_3.timeline_variables.map(item => `wav/${item.audio}`),
        // test_practice_procedure_4.timeline_variables.map(item => `wav/${item.audio}`),

        // // Instruction test ready trials
        // instruction_test_ready_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        // // Don't touch screen prompt trials
        // dont_touch_screen_prompt_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        // // Test listen trials
        // test_procedure_1_listen.timeline_variables.map(item => `${item.audio}`),
        // test_procedure_2_listen.timeline_variables.map(item => `${item.audio}`),
        // test_procedure_3_listen.timeline_variables.map(item => `${item.audio}`),
        // test_procedure_4_listen.timeline_variables.map(item => `${item.audio}`),
       

        // Ending trial
        ending_trial_procedure.timeline_variables.map(item => `${item.audio}`),

        []),
  };
  timeline.push(preload);
  // timeline.push(instructions);
  // timeline.push(introduction_trial_procedure1);
  // timeline.push(exposure_procedure1_1);
  // timeline.push(attention_check_procedure1_1);
  // timeline.push(exposure_procedure1_2);
  // timeline.push(attention_check_procedure1_2);
  // timeline.push(exposure_procedure1_3);
  // timeline.push(attention_check_procedure1_3);
  // timeline.push(exposure_procedure1_4);
  // timeline.push(attention_check_procedure1_4);
  // // timeline.push(break_trial_procedure);
  // timeline.push(exposure_procedure2_1);
  // timeline.push(attention_check_procedure2_1);
  // timeline.push(exposure_procedure2_2);
  // timeline.push(attention_check_procedure2_2);
  // timeline.push(exposure_procedure2_3);
  // timeline.push(attention_check_procedure2_3);
  // timeline.push(exposure_procedure2_4);
  // timeline.push(attention_check_procedure2_4);
  // timeline.push(break_trial_procedure);
  // timeline.push(introduction_trial_procedure2);
  // timeline.push(practice1);
  // // timeline.push(break_trial_procedure);
  // timeline.push(practice2);
  // timeline.push(break_trial_procedure);
  // timeline.push(introduction_trial_procedure3);
  // timeline.push(test_procedure_1_listen);
  // timeline.push(test_procedure_2_listen);
  // // timeline.push(break_trial_procedure);
  // timeline.push(test_procedure_3_listen);
  // timeline.push(test_procedure_4_listen);
  // timeline.push(break_trial_procedure);
  // // timeline.push(introduction_trial_procedure4);
  // timeline.push(peer_preference_task1);
  // timeline.push(peer_preference_task2);
  // timeline.push(peer_preference_task3);
  // timeline.push(peer_preference_task4);
  // timeline.push(peer_preference_task5);
  // timeline.push(peer_preference_task6);
  // timeline.push(peer_preference_task7);
  // timeline.push(peer_preference_task8);
  timeline.push(toy_preference_task1);
  timeline.push(toy_preference_task2);
  timeline.push(toy_preference_task3);
  timeline.push(toy_preference_task2);
  timeline.push(cloth_preference_task1);
  timeline.push(cloth_preference_task2);
  timeline.push(cloth_preference_task3);
  timeline.push(cloth_preference_task4);

  const subject_id = jsPsych.randomization.randomID(10);
  const filename = `${subject_id}.csv`;

  const save_data = {
    type: jsPsychPipe,
    action: "save",
    experiment_id: "JE55JGOL9Z76",
    filename: filename,
    data_string: () => jsPsych.data.get().csv()
  };
  timeline.push(save_data);

  jsPsych.run(timeline);



</script>

</html>